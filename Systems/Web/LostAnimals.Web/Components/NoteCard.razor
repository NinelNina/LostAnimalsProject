@using LostAnimals.Web.Pages.Notes.Models
@using LostAnimals.Web.Pages.Photo.Models

<MudPaper Class="pa-4 mb-4" Elevation="3">
    <MudText Typo="Typo.h6">@Note.Title</MudText>
    <MudText Typo="Typo.subtitle1" Color="Color.Primary" Class="mt-2 mb-2">@Note.CategoryName</MudText>
    <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Автор: @Note.Username, @Note.CreatedDate.ToShortDateString()</MudText>
    <MudText Typo="Typo.body1" Class="mt-2">@Note.Content.Substring(0, Math.Min(Note.Content.Length, 200))...</MudText>
    @if (Note.PhotoGalleryId.HasValue)
    {
        Guid galleryId = Note.PhotoGalleryId.Value;
        if (PhotosDictionary.TryGetValue(galleryId, out var photos))
        {
            if (photos != null && photos.Any())
            {
                <MudImage Src="@photos.First().PhotoName" Alt="Animal image" Height="200" Class="mt-2" />
            }
        }
    }
    <MudText Typo="Typo.subtitle1" Color="Color.Secondary" Class="mt-2">Комментарии: @(Note.Comments?.Count ?? 0)</MudText>
</MudPaper>

@code {
    [Parameter]
    public NoteViewModel Note { get; set; }

    [Parameter]
    public Dictionary<Guid, IEnumerable<PhotoStorageViewModel>> PhotosDictionary { get; set; }
}
